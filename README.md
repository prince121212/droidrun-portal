# DroidRun Portal - Androidæ— éšœç¢æ¡¥æ¥æœåŠ¡

<div align="center">

![DroidRun Portal](app/src/main/res/mipmap-xxxhdpi/ic_launcher.png)

**ğŸ“± AIé©±åŠ¨è®¾å¤‡æ§åˆ¶çš„é«˜çº§Androidæ— éšœç¢æœåŠ¡**

[![Android API](https://img.shields.io/badge/API-30+-brightgreen.svg)](https://android-arsenal.com/api?level=30)
[![Kotlin](https://img.shields.io/badge/kotlin-1.8+-blue.svg)](https://kotlinlang.org)
[![License](https://img.shields.io/badge/license-MIT-green.svg)](LICENSE)

[ğŸ”— ä¸»æ¡†æ¶](https://github.com/droidrun/droidrun) â€¢ [ğŸ“– æ–‡æ¡£](https://docs.droidrun.ai/) â€¢ [ğŸš€ å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)

</div>

## ğŸŒŸ æ¦‚è¿°

DroidRun Portalæ˜¯ä¸€ä¸ªå¤æ‚çš„Androidæ— éšœç¢æœåŠ¡ï¼Œä½œä¸ºAIæ™ºèƒ½ä½“å’ŒAndroidè®¾å¤‡ä¹‹é—´çš„æ¡¥æ¢ã€‚å®ƒæä¾›å®æ—¶UIå…ƒç´ æ£€æµ‹ã€è§†è§‰åé¦ˆï¼Œä»¥åŠä¸DroidRunæ¡†æ¶çš„æ— ç¼é€šä¿¡ï¼Œå®ç°è‡ªåŠ¨åŒ–è®¾å¤‡æ§åˆ¶ã€‚

### âœ¨ æ ¸å¿ƒç‰¹æ€§

- ğŸ” **å®æ—¶UIæ£€æµ‹**: å…ˆè¿›çš„æ— éšœç¢æœåŠ¡ï¼Œå…¨é¢åˆ†æUIå…ƒç´ 
- ğŸ¯ **å¯è§†åŒ–è¦†ç›–ç³»ç»Ÿ**: å¯è‡ªå®šä¹‰ä½ç½®çš„äº¤äº’å…ƒç´ é«˜äº®æ˜¾ç¤º
- ğŸ“¡ **ADBé€šä¿¡æ¡¥æ¢**: é€šè¿‡ContentProviderå®ç°æ— ç¼æ•°æ®äº¤æ¢
- âŒ¨ï¸ **è‡ªå®šä¹‰è¾“å…¥æ³•**: ä¸“é—¨çš„é”®ç›˜IMEç”¨äºæ–‡æœ¬è¾“å…¥æ“ä½œ
- ğŸ”„ **å®æ—¶çŠ¶æ€ç›‘æ§**: æŒç»­è·Ÿè¸ªè®¾å¤‡å’Œåº”ç”¨çŠ¶æ€
- ğŸ¨ **Material Designç•Œé¢**: ç°ä»£ç›´è§‚çš„é…ç½®å’Œç›‘æ§ç•Œé¢
- ğŸ›¡ï¸ **éšç§ä¿æŠ¤**: æ‰€æœ‰å¤„ç†éƒ½åœ¨è®¾å¤‡æœ¬åœ°è¿›è¡Œ

## ğŸ—ï¸ æ¶æ„è®¾è®¡

DroidRun Portalé‡‡ç”¨æ¨¡å—åŒ–æ¶æ„ï¼Œä¸“ä¸ºæ€§èƒ½å’Œå¯é æ€§è€Œè®¾è®¡ï¼š

```mermaid
graph TB
    subgraph "DroidRun Portalåº”ç”¨"
        A[MainActivity] --> B[ConfigManager]
        A --> C[OverlayManager]
        D[DroidrunAccessibilityService] --> E[UIå…ƒç´ æ£€æµ‹]
        D --> F[çŠ¶æ€ç›‘æ§]
        G[DroidrunContentProvider] --> H[ADBé€šä¿¡]
        I[DroidrunKeyboardIME] --> J[æ–‡æœ¬è¾“å…¥]
    end

    subgraph "Androidç³»ç»Ÿ"
        E --> K[AccessibilityNodeInfo]
        F --> L[WindowManager]
        C --> M[ç³»ç»Ÿè¦†ç›–å±‚]
        H --> N[Content Resolver]
    end

    subgraph "å¤–éƒ¨é€šä¿¡"
        N --> O[ADB Shell]
        O --> P[DroidRunæ¡†æ¶]
    end

    style D fill:#e1f5fe
    style G fill:#f3e5f5
    style I fill:#e8f5e8
```

### ğŸ”§ æ ¸å¿ƒç»„ä»¶

#### 1. **DroidrunAccessibilityService** - æ ¸å¿ƒå¼•æ“
- **å®æ—¶UIæ‰«æ**: æŒç»­ç›‘æ§æ— éšœç¢æ ‘å˜åŒ–
- **å…ƒç´ ç´¢å¼•**: è‡ªåŠ¨ä¸ºäº¤äº’å…ƒç´ åˆ†é…å”¯ä¸€ç´¢å¼•
- **çŠ¶æ€èšåˆ**: å…¨é¢çš„è®¾å¤‡å’Œåº”ç”¨çŠ¶æ€æ”¶é›†
- **è¦†ç›–å±‚ç®¡ç†**: åŠ¨æ€è§†è§‰åé¦ˆç³»ç»Ÿ
- **æ€§èƒ½ä¼˜åŒ–**: é«˜æ•ˆå¤„ç†ï¼Œæœ€å°åŒ–ç”µæ± å½±å“

#### 2. **DroidrunContentProvider** - é€šä¿¡ä¸­å¿ƒ
- **ADBæ¡¥æ¥**: ä¸å¤–éƒ¨æ¡†æ¶çš„å®‰å…¨é€šä¿¡é€šé“
- **RESTfulç«¯ç‚¹**: ç”¨äºçŠ¶æ€æŸ¥è¯¢å’Œæ“ä½œæ‰§è¡Œçš„æ¸…æ´API
- **æ•°æ®åºåˆ—åŒ–**: åŸºäºJSONçš„æ•°æ®äº¤æ¢æ ¼å¼
- **é”™è¯¯å¤„ç†**: å¼ºå¤§çš„é”™è¯¯æŠ¥å‘Šå’Œæ¢å¤æœºåˆ¶

#### 3. **OverlayManager** - å¯è§†åŒ–ç•Œé¢
- **å…ƒç´ é«˜äº®**: UIå…ƒç´ çš„é¢œè‰²ç¼–ç å¯è§†åŒ–
- **ä½ç½®æ ¡æ­£**: é’ˆå¯¹ä¸åŒå±å¹•é…ç½®çš„è‡ªåŠ¨è°ƒæ•´
- **åŠ¨æ€æ›´æ–°**: åŸºäºUIå˜åŒ–çš„å®æ—¶è¦†ç›–å±‚åˆ·æ–°
- **å¯å®šåˆ¶å¤–è§‚**: ç”¨æˆ·å¯é…ç½®çš„é¢œè‰²å’Œä½ç½®

#### 4. **DroidrunKeyboardIME** - è¾“å…¥ä¸“å®¶
- **Base64æ–‡æœ¬è¾“å…¥**: å®‰å…¨çš„æ–‡æœ¬ä¼ è¾“å’Œè¾“å…¥
- **ç›´æ¥æŒ‰é”®äº‹ä»¶**: ç¡¬ä»¶æŒ‰é”®æ¨¡æ‹Ÿ
- **è¾“å…¥è¿æ¥ç®¡ç†**: å¯é çš„æ–‡æœ¬å­—æ®µäº¤äº’
- **å¤šè¯­è¨€æ”¯æŒ**: Unicodeå…¼å®¹çš„æ–‡æœ¬å¤„ç†

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚

- **Android 11+ (API 30+)**
- **å·²å¯ç”¨USBè°ƒè¯•**
- **DroidRunæ¡†æ¶**å·²å®‰è£…åœ¨è¿æ¥çš„è®¡ç®—æœºä¸Š
- **å·²æˆäºˆæ— éšœç¢æƒé™**

### å®‰è£…

#### æ–¹æ³•1: è‡ªåŠ¨å®‰è£…(æ¨è)
```bash
# ä»DroidRunæ¡†æ¶
droidrun setup
```

#### æ–¹æ³•2: æ‰‹åŠ¨å®‰è£…
1. ä»[å‘å¸ƒé¡µé¢](https://github.com/droidrun/droidrun-portal/releases)ä¸‹è½½æœ€æ–°APK
2. é€šè¿‡ADBå®‰è£…:
```bash
adb install droidrun-portal.apk
```

### è®¾ç½®ä¸é…ç½®

1. **åœ¨Androidè®¾å¤‡ä¸Šå¯åŠ¨DroidRun Portal**

2. **å¯ç”¨æ— éšœç¢æœåŠ¡**:
   - ç‚¹å‡»åº”ç”¨ä¸­çš„æ— éšœç¢çŠ¶æ€å¡ç‰‡
   - å¯¼èˆªåˆ°è®¾ç½® > æ— éšœç¢ > DroidRun Portal
   - æ‰“å¼€æœåŠ¡å¼€å…³
   - æˆäºˆå¿…è¦æƒé™

3. **é…ç½®å¯è§†åŒ–è¦†ç›–å±‚**(å¯é€‰):
   - åœ¨ä¸»åº”ç”¨ä¸­åˆ‡æ¢è¦†ç›–å±‚å¯è§æ€§
   - ä½¿ç”¨æ»‘å—æˆ–æ–‡æœ¬è¾“å…¥è°ƒæ•´ä½ç½®åç§»
   - å…ƒç´ å°†ç”¨å½©è‰²çŸ©å½¢å’Œç´¢å¼•é«˜äº®æ˜¾ç¤º

4. **æµ‹è¯•è¿æ¥**:
   - ä½¿ç”¨"è·å–çŠ¶æ€"æŒ‰é’®éªŒè¯åŠŸèƒ½
   - æ£€æŸ¥UIå…ƒç´ æ˜¯å¦æ­£ç¡®æ£€æµ‹å’Œç´¢å¼•

### éªŒè¯

ä½¿ç”¨ç®€å•çš„ADBå‘½ä»¤æµ‹è¯•å®‰è£…:
```bash
# æŸ¥è¯¢è®¾å¤‡çŠ¶æ€
adb shell content query --uri content://com.droidrun.portal/state

# é¢„æœŸå“åº”: åŒ…å«æ— éšœç¢æ ‘å’Œæ‰‹æœºçŠ¶æ€çš„JSON
```

## ğŸ”§ APIå‚è€ƒ

### ContentProviderç«¯ç‚¹

#### `/state` - ç»„åˆçŠ¶æ€æŸ¥è¯¢
è¿”å›åŒ…æ‹¬UIæ ‘å’Œæ‰‹æœºä¿¡æ¯çš„ç»¼åˆè®¾å¤‡çŠ¶æ€ã€‚

**ç”¨æ³•:**
```bash
adb shell content query --uri content://com.droidrun.portal/state
```

**å“åº”:**
```json
{
  "status": "success",
  "data": {
    "a11y_tree": [...],
    "phone_state": {
      "currentApp": "è®¾ç½®",
      "packageName": "com.android.settings",
      "keyboardVisible": false,
      "focusedElement": {...}
    }
  }
}
```

#### `/a11y_tree` - æ— éšœç¢æ ‘
è¿”å›å¸¦æœ‰ç´¢å¼•å…ƒç´ çš„å½“å‰æ— éšœç¢æ ‘ã€‚

#### `/phone_state` - è®¾å¤‡çŠ¶æ€
è¿”å›å½“å‰åº”ç”¨ã€é”®ç›˜çŠ¶æ€å’Œç„¦ç‚¹å…ƒç´ ä¿¡æ¯ã€‚

#### `/ping` - å¥åº·æ£€æŸ¥
ç®€å•çš„è¿æ¥æµ‹è¯•ç«¯ç‚¹ã€‚

### é”®ç›˜æ“ä½œ

#### æ–‡æœ¬è¾“å…¥
```bash
adb shell content insert --uri content://com.droidrun.portal/keyboard/input \
  --bind base64_text:s:SGVsbG8gV29ybGQ=  # "Hello World"çš„base64ç¼–ç 
```

#### æ¸…é™¤æ–‡æœ¬
```bash
adb shell content insert --uri content://com.droidrun.portal/keyboard/clear
```

#### æŒ‰é”®äº‹ä»¶
```bash
adb shell content insert --uri content://com.droidrun.portal/keyboard/key \
  --bind key_code:i:66  # å›è½¦é”®
```

## ğŸ¯ åŠŸèƒ½è¯¦è§£

### å®æ—¶UIå…ƒç´ æ£€æµ‹

æ— éšœç¢æœåŠ¡æŒç»­ç›‘æ§UIå±‚æ¬¡ç»“æ„å¹¶è¯†åˆ«ï¼š

- **å¯ç‚¹å‡»å…ƒç´ **: æŒ‰é’®ã€é“¾æ¥ã€äº¤äº’è§†å›¾
- **è¾“å…¥å­—æ®µ**: æ–‡æœ¬è¾“å…¥æ¡†ã€æœç´¢æ¡†ã€è¡¨å•
- **å¯æ»šåŠ¨å®¹å™¨**: åˆ—è¡¨ã€æ»šåŠ¨è§†å›¾ã€åˆ†é¡µå™¨
- **å¯é€‰æ‹©é¡¹**: å¤é€‰æ¡†ã€å•é€‰æŒ‰é’®ã€å¼€å…³
- **æ–‡æœ¬å†…å®¹**: æ ‡ç­¾ã€æè¿°ã€å¯è¯»æ–‡æœ¬

æ¯ä¸ªå…ƒç´ éƒ½ä¼šè·å¾—ï¼š
- **å”¯ä¸€ç´¢å¼•**: ç”¨äºç²¾ç¡®å®šä½
- **è¾¹ç•ŒçŸ©å½¢**: å±å¹•åæ ‡
- **æ–‡æœ¬å†…å®¹**: å¯è§æˆ–å¯è®¿é—®çš„æ–‡æœ¬
- **ç±»å‹åˆ†ç±»**: å…ƒç´ ç±»åˆ«
- **å±‚æ¬¡ä¿¡æ¯**: çˆ¶å­å…³ç³»

### å¯è§†åŒ–è¦†ç›–ç³»ç»Ÿ

è¦†ç›–å±‚æä¾›å®æ—¶è§†è§‰åé¦ˆï¼š

- **é¢œè‰²ç¼–ç é«˜äº®**: ä¸åŒå…ƒç´ ç±»å‹ä½¿ç”¨ä¸åŒé¢œè‰²
- **ç´¢å¼•æ ‡ç­¾**: æ¯ä¸ªå…ƒç´ çš„æ•°å­—æ ‡è¯†ç¬¦
- **ä½ç½®è°ƒæ•´**: é’ˆå¯¹ä¸åŒå±å¹•è®¾ç½®çš„å¯é…ç½®åç§»
- **æ€§èƒ½ä¼˜åŒ–**: é«˜æ•ˆæ¸²æŸ“ï¼Œå½±å“æœ€å°

### çŠ¶æ€ç›‘æ§

å…¨é¢çš„è®¾å¤‡çŠ¶æ€è·Ÿè¸ªï¼š

- **å½“å‰åº”ç”¨**: æ´»åŠ¨åº”ç”¨åç§°å’ŒåŒ…å
- **é”®ç›˜å¯è§æ€§**: è¾“å…¥æ³•çŠ¶æ€
- **ç„¦ç‚¹å…ƒç´ **: å½“å‰é€‰ä¸­çš„UIç»„ä»¶
- **çª—å£å˜åŒ–**: åº”ç”¨è½¬æ¢å’Œå¯¼èˆª
- **ç³»ç»Ÿäº‹ä»¶**: é€šçŸ¥ã€å¯¹è¯æ¡†ã€è¦†ç›–å±‚

## ğŸ› ï¸ å¼€å‘

### ä»æºç æ„å»º

```bash
# å…‹éš†ä»“åº“
git clone https://github.com/droidrun/droidrun-portal.git
cd droidrun-portal

# æ„å»ºè°ƒè¯•APK
./gradlew assembleDebug

# å®‰è£…åˆ°è¿æ¥çš„è®¾å¤‡
./gradlew installDebug
```

### é¡¹ç›®ç»“æ„
```
app/src/main/
â”œâ”€â”€ java/com/droidrun/portal/
â”‚   â”œâ”€â”€ DroidrunAccessibilityService.kt    # æ ¸å¿ƒæ— éšœç¢æœåŠ¡
â”‚   â”œâ”€â”€ DroidrunContentProvider.kt         # ADBé€šä¿¡æ¡¥æ¢
â”‚   â”œâ”€â”€ DroidrunKeyboardIME.kt            # è‡ªå®šä¹‰è¾“å…¥æ³•
â”‚   â”œâ”€â”€ MainActivity.kt                    # ä¸»é…ç½®ç•Œé¢
â”‚   â”œâ”€â”€ OverlayManager.kt                 # å¯è§†åŒ–è¦†ç›–ç³»ç»Ÿ
â”‚   â”œâ”€â”€ ConfigManager.kt                  # è®¾ç½®ç®¡ç†
â”‚   â””â”€â”€ model/
â”‚       â”œâ”€â”€ ElementNode.kt                # UIå…ƒç´ è¡¨ç¤º
â”‚       â””â”€â”€ PhoneState.kt                 # è®¾å¤‡çŠ¶æ€æ¨¡å‹
â”œâ”€â”€ res/                                  # Androidèµ„æº
â””â”€â”€ AndroidManifest.xml                   # åº”ç”¨é…ç½®
```

### å…³é”®æŠ€æœ¯

- **Kotlin**: ç°ä»£Androidå¼€å‘è¯­è¨€
- **Androidæ— éšœç¢æœåŠ¡**: æ ¸å¿ƒUIäº¤äº’API
- **ContentProvider**: å®‰å…¨çš„è¿›ç¨‹é—´é€šä¿¡
- **è¾“å…¥æ³•ç¼–è¾‘å™¨(IME)**: è‡ªå®šä¹‰é”®ç›˜å®ç°
- **Material Designç»„ä»¶**: ç°ä»£UIæ¡†æ¶
- **WindowManager**: ç³»ç»Ÿè¦†ç›–å±‚ç®¡ç†

## ğŸ”’ éšç§ä¸å®‰å…¨

DroidRun Portalåœ¨è®¾è®¡æ—¶å……åˆ†è€ƒè™‘äº†éšç§å’Œå®‰å…¨ï¼š

- **æœ¬åœ°å¤„ç†**: æ‰€æœ‰UIåˆ†æéƒ½åœ¨è®¾å¤‡ä¸Šè¿›è¡Œ
- **æ— ç½‘ç»œé€šä¿¡**: ä¸å‘å¤–éƒ¨æœåŠ¡å™¨ä¼ è¾“æ•°æ®
- **æœ€å°æƒé™**: ä»…è¯·æ±‚å¿…è¦çš„Androidæƒé™
- **å®‰å…¨é€šä¿¡**: ä»…é€šè¿‡ADBé€šä¿¡é€šé“
- **ç”¨æˆ·æ§åˆ¶**: ç”¨æˆ·å®Œå…¨æ§åˆ¶æ— éšœç¢æœåŠ¡çš„æ¿€æ´»

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### æ— éšœç¢æœåŠ¡ä¸å·¥ä½œ
- ç¡®ä¿åœ¨Androidè®¾ç½®ä¸­å¯ç”¨äº†æœåŠ¡
- æ£€æŸ¥åº”ç”¨æ˜¯å¦æœ‰å¿…è¦æƒé™
- å¦‚éœ€è¦å¯é‡å¯æ— éšœç¢æœåŠ¡

#### è¦†ç›–å±‚ä¸å¯è§
- éªŒè¯æ˜¯å¦æˆäºˆäº†è¦†ç›–å±‚æƒé™
- æ£€æŸ¥åº”ç”¨è®¾ç½®ä¸­æ˜¯å¦å¯ç”¨äº†è¦†ç›–å±‚
- å¦‚æœå…ƒç´ æ˜¾ç¤ºåœ¨å±å¹•å¤–ï¼Œè°ƒæ•´ä½ç½®åç§»

#### ADBé€šä¿¡å¤±è´¥
- ç¡®è®¤å·²å¯ç”¨USBè°ƒè¯•
- ä½¿ç”¨`adb devices`éªŒè¯ADBè¿æ¥
- æ£€æŸ¥ContentProvideræ˜¯å¦å“åº”

#### æ€§èƒ½é—®é¢˜
- å¦‚éœ€è¦å¯é™ä½è¦†ç›–å±‚åˆ·æ–°é¢‘ç‡
- å…³é—­ä¸å¿…è¦çš„åº”ç”¨ä»¥é‡Šæ”¾å†…å­˜
- å¦‚æœæ€§èƒ½ä¸‹é™å¯é‡å¯è®¾å¤‡

### è°ƒè¯•ä¿¡æ¯

å¯ç”¨è°ƒè¯•æ—¥å¿—ï¼š
```bash
# æŸ¥çœ‹æ— éšœç¢æœåŠ¡æ—¥å¿—
adb logcat -s DroidrunAccessibilityService

# æŸ¥çœ‹å†…å®¹æä¾›è€…æ—¥å¿—
adb logcat -s DroidrunContentProvider

# æŸ¥çœ‹æ‰€æœ‰DroidRunæ—¥å¿—
adb logcat -s DROIDRUN_*
```

## ğŸ“± å…¼å®¹æ€§

### æ”¯æŒçš„Androidç‰ˆæœ¬
- **Android 11 (API 30)** - æœ€ä½æ”¯æŒç‰ˆæœ¬
- **Android 12 (API 31)** - å®Œå…¨å…¼å®¹
- **Android 13 (API 33)** - å®Œå…¨å…¼å®¹
- **Android 14 (API 34)** - å®Œå…¨å…¼å®¹ï¼Œæ”¯æŒæœ€æ–°åŠŸèƒ½

### æµ‹è¯•è®¾å¤‡
- Google Pixelç³»åˆ—
- Samsung Galaxyç³»åˆ—
- OnePlusè®¾å¤‡
- å°ç±³è®¾å¤‡
- å¤§å¤šæ•°å…·æœ‰æ ‡å‡†æ— éšœç¢å®ç°çš„Androidè®¾å¤‡

## ğŸ¤ è´¡çŒ®

æˆ‘ä»¬æ¬¢è¿å¯¹DroidRun Portalçš„è´¡çŒ®ï¼è¯·æŸ¥çœ‹æˆ‘ä»¬çš„[è´¡çŒ®æŒ‡å—](../CONTRIBUTING.md)äº†è§£è¯¦æƒ…ã€‚

### å¼€å‘è®¾ç½®
1. Forkä»“åº“
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
3. è¿›è¡Œæ›´æ”¹
4. åœ¨çœŸå®è®¾å¤‡ä¸Šå½»åº•æµ‹è¯•
5. æäº¤æ‹‰å–è¯·æ±‚

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨MITè®¸å¯è¯ - è¯¦æƒ…è¯·æŸ¥çœ‹[LICENSE](LICENSE)æ–‡ä»¶ã€‚

## ğŸ”— ç›¸å…³é¡¹ç›®

- **[DroidRunæ¡†æ¶](https://github.com/droidrun/droidrun)**: ä¸»è¦AIæ™ºèƒ½ä½“æ¡†æ¶
- **[DroidRunæ–‡æ¡£](https://docs.droidrun.ai/)**: ç»¼åˆæ–‡æ¡£
- **[DroidRunç¤ºä¾‹](https://github.com/droidrun/examples)**: ä½¿ç”¨ç¤ºä¾‹å’Œæ•™ç¨‹

---

<div align="center">

**ç”±DroidRunå›¢é˜Ÿç”¨â¤ï¸åˆ¶ä½œ**

[â­ åœ¨GitHubä¸Šç»™æˆ‘ä»¬ç‚¹æ˜Ÿ](https://github.com/droidrun/droidrun-portal) â€¢ [ğŸ› æŠ¥å‘Šé—®é¢˜](https://github.com/droidrun/droidrun-portal/issues) â€¢ [ğŸ’¬ åŠ å…¥Discord](https://discord.gg/droidrun)

</div>